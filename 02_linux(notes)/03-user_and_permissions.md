# Linux Users and Permissions Guide

Linux, being a truly multi-user, multi-namespace OS, offers extensive options for user management and access control.

## Table of Contents

- [What are Users and Groups?](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#what-are-users-and-groups)
- [Managing Users](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#managing-users)
- [Managing Groups](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#managing-groups)
- [Superuser Access](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#superuser-access)
- [File Permissions & Ownership](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#file-permissions--ownership)
- [Managing Permissions](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#managing-permissions)
- [Sticky Bit](https://claude.ai/chat/2215911d-5e66-487f-b663-3704934d4798#sticky-bit)

---

## What are Users and Groups?

### Users

A **user** is an entity in a Linux operating system that can manipulate files and perform various operations. Each user is assigned a unique ID (UID).

**User ID Assignment:**

- **UID 0**: Assigned to the root user
- **UIDs 1-999**: Reserved for system users
- **UIDs 1000+**: Assigned to local users

A single directory can accommodate up to **60,000 users**.

### Viewing All Users

To list all users on your system:

```bash
less /etc/passwd
```

The `/etc/passwd` file stores user information in this format:

```
username:x:UID:GID:full_name:home_directory:login_shell
```

**Example output:**

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
```

**Field explanations:**

- **username**: Login name
- **x**: Password placeholder (actual passwords stored in `/etc/shadow`)
- **UID**: User ID number
- **GID**: Primary group ID number
- **full_name**: User's full name or description
- **home_directory**: User's home directory path
- **login_shell**: Shell program executed on login (`/usr/sbin/nologin` prevents login for system users)

### Groups

**Groups** are collections of users who need access to certain resources. They simplify permission management by allowing you to set permissions for multiple users at once.

---

## Managing Users

### Create a New User

```bash
sudo useradd <username>
```

**Common options:**

- `-d <directory>`: Set home directory
- `-s <shell>`: Set login shell
- `-g <group>`: Set primary group
- `-u <uid>`: Set specific UID (auto-generated by default)

**Example:**

```bash
sudo useradd -d /home/john -s /bin/bash -g developers john
```

### Set User Password

After creating a user, set their password:

```bash
sudo passwd <username>
```

You'll be prompted to enter the password twice for confirmation.

### Modify an Existing User

```bash
sudo usermod [options] <username>
```

The `usermod` command accepts the same options as `useradd`.

**Change user ID:**

```bash
sudo usermod -u <new_uid> <username>
```

**Change login name:**

```bash
sudo usermod -l <new_name> <old_name>
```

**Change primary group:**

```bash
sudo usermod -g <new_gid> <username>
```

### View User Configuration

Display user information from the configuration file:

```bash
cat /etc/passwd
```

### Delete a User

```bash
sudo userdel <username>
```

**Delete user and their home directory:**

```bash
sudo userdel -r <username>
```

The `-r` option also removes the user's mail spool.

---

## Managing Groups

### View Group Information

**Check a user's group membership:**

```bash
id <username>
```

**List all groups:**

```bash
cat /etc/group
```

### Create a Group

```bash
sudo groupadd <groupname>
```

**Common options:**

- `-g <GID>`: Set specific group ID
- `-f`: Force success even if group exists

### Add User to a Group

```bash
sudo gpasswd -a <username> <groupname>
```

### Modify Group ID

```bash
sudo groupmod -g <new_gid> <groupname>
```

Or modify a user's primary group:

```bash
sudo usermod -g <new_gid> <username>
```

### Delete a Group

```bash
sudo groupdel <groupname>
```

---

## Superuser Access

The **root** (superuser) is a special user with unlimited system privileges. Root can read, write, and execute any file on the system.

### Using sudo

Instead of logging in as root, use `sudo` to run specific commands with root privileges:

```bash
sudo apt-get install cowsay
```

You'll be prompted for your password before the command executes.

### The sudoers File

Access to `sudo` is controlled by `/etc/sudoers`. Example configuration:

```
Defaults env_reset
username ALL=(ALL:ALL) ALL
%sudo ALL=(ALL:ALL) ALL
```

**Syntax breakdown:**

```
<user> <hosts>=(<users>:<groups>) <commands>
```

- `username ALL=(ALL:ALL) ALL`: User "username" can run all commands as any user/group on any host
- `%sudo ALL=(ALL:ALL) ALL`: Any user in the "sudo" group has the same privileges (% indicates a group)

### Switch to Root User

```bash
sudo su
```

After switching, verify with:

```bash
whoami  # Should return: root
```

**⚠️ Warning:** Avoid changing the root password and logging in directly as root. Use `sudo` instead for better security and accountability.

---

## File Permissions & Ownership

Every file and directory has **permissions** and **ownership** information.

### Permission Values

|Octal|Symbolic|Meaning|
|---|---|---|
|0|`---`|No permissions|
|1|`--x`|Execute only|
|2|`-w-`|Write only|
|3|`-wx`|Write and execute|
|4|`r--`|Read only|
|5|`r-x`|Read and execute|
|6|`rw-`|Read and write|
|7|`rwx`|Read, write, and execute (full access)|

### Permission Groups

Every file has three permission sets:

1. **User (u)**: The file owner
2. **Group (g)**: The owning group
3. **Others (o)**: Everyone else

### View Permissions

```bash
ls -al
```

**Example output:**

```
drwxr-xr-x  3 root root  4096 Nov 11 14:22 boot
-rw-r--r--  1 root root  1424 Nov 10 12:07 docker-desktop.install
drwx------  2 root root 16384 Oct 31  2021 lost+found
drwxrwxrwt 40 root root 36864 Nov 23 19:14 tmp
```

The first column shows permissions in format: `[type][user][group][others]`

- First character: file type (`d` = directory, `-` = file, `l` = symbolic link)
- Next 3 characters: user permissions
- Next 3 characters: group permissions
- Last 3 characters: others permissions

### Change Permissions

**Basic syntax:**

```bash
chmod [options] [mode] [file/directory]
```

**Common option:**

- `-R`: Apply recursively to all contents

### Change Ownership

**Basic syntax:**

```bash
chown [options] [user:group] [file/directory]
```

**Examples:**

Change owner only:

```bash
sudo chown user02 file1
```

Change group only:

```bash
sudo chown :groupA file1
```

Change both owner and group:

```bash
sudo chown user02:groupA file2
```

Change recursively for directory and contents:

```bash
sudo chown -R user01:groupA Resources/
```

---

## Managing Permissions

There are two modes for setting permissions: **absolute mode** (numeric) and **symbolic mode**.

### Absolute Mode (Numeric)

Permissions are specified using octal numbers.

**Permission values:**

- Read = 4
- Write = 2
- Execute = 1

**Syntax:**

```bash
chmod [user][group][others] filename
```

**Examples:**

Grant user full access (rwx), group read-only (r), others no access:

```bash
chmod 740 file
```

- User: 7 (4+2+1 = rwx)
- Group: 4 (4+0+0 = r--)
- Others: 0 (0+0+0 = ---)

Grant user read/write, group read-only, others read-only:

```bash
chmod 644 file
```

- User: 6 (4+2 = rw-)
- Group: 4 (4 = r--)
- Others: 4 (4 = r--)

Apply recursively to directory:

```bash
chmod -R 744 Resources/
```

### Symbolic Mode

Uses letters and symbols for more intuitive permission management.

**Access level symbols:**

- `r` = read
- `w` = write
- `x` = execute

**Identity symbols:**

- `u` = user (owner)
- `g` = group
- `o` = others
- `a` = all (user, group, and others)

**Operators:**

- `+` = add permission
- `-` = remove permission
- `=` = set exact permission

**Syntax:**

```bash
chmod [identity][operator][permission] filename
```

**Examples:**

Remove read permission from others:

```bash
chmod o-r file
```

Add write permission for group:

```bash
chmod g+w file
```

Set exact permissions for user:

```bash
chmod u=rwx file
```

Multiple operations (set others to rwx, add rw to group, remove rwx from others):

```bash
chmod -R o=rwx,g+rw,o-rwx Resources/
```

Grant execute permission to everyone:

```bash
chmod a+x script.sh
```

---

## Sticky Bit

The **sticky bit** is a special permission that can be set on directories. When set, only the file owner (or root) can delete or rename files within that directory, regardless of the directory's write permissions.

### Set Sticky Bit

```bash
chmod +t directory/
```

### Verify Sticky Bit

When listing with `ls -l`, directories with the sticky bit show a `t` at the end:

```
drwxrwxr-t  2 user group 4096 Nov 23 dir_with_sticky_bit/
```

### Remove Sticky Bit

```bash
chmod -t directory/
```

### Common Use Case

The `/tmp` directory typically has the sticky bit set, allowing all users to create files but preventing them from deleting files owned by others:

```bash
ls -ld /tmp
drwxrwxrwt 40 root root 36864 Nov 23 19:14 /tmp
```

---

## Quick Reference

### Common Permission Patterns

|Numeric|Symbolic|Typical Use|
|---|---|---|
|755|`rwxr-xr-x`|Executable files, directories|
|644|`rw-r--r--`|Regular files|
|600|`rw-------`|Private files (SSH keys)|
|700|`rwx------`|Private directories|
|777|`rwxrwxrwx`|Public (use with caution!)|

### Essential Commands Summary

```bash
# User management
sudo useradd username
sudo passwd username
sudo usermod -options username
sudo userdel -r username

# Group management
sudo groupadd groupname
sudo gpasswd -a username groupname
sudo groupdel groupname

# Permissions
chmod 755 file
chmod u+x file
chmod -R 644 directory/

# Ownership
sudo chown user:group file
sudo chown -R user:group directory/

# View information
id username
ls -al
cat /etc/passwd
cat /etc/group
```